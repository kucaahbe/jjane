<%= title 'Sorting pages' %>

<% content_for :head do -%>
  <script type="text/javascript">
    //<![CDATA[
  $(function() {
      $('#sortable_pages').sortable({ 
cursor: 'move',
handle:'.mover',
helper: 'clone',
grid: [20, 36],
// callbacks:
start: function(event,ui) {
ui.helper.css('outline','none');
}
});
      });
//]]>
</script>
<style type="text/css">
  #sortable_pages {width:60%;}
  #sortable_pages > li {outline:1px solid green;padding:5px;margin:5px 0;}
  #sortable_pages li span {display:inline-block;}
</style>
<% end -%>

<ul class="jjane" id="sortable_pages">
  <%- @pages.each do |p| -%>
    <% content_tag :li, :id => "page_#{p[:page].id}", :class => %[level_#{p[:level]} lft_#{p[:page].lft} rgt_#{p[:page].rgt}] do %>
      <%= content_tag :span, '',
	:style => "width:#{20*p[:level]}px;",
      :id => "page_mover_#{p[:page].id}" -%>
      <%= engine_image 'sortable.png', :class => 'mover' %>
      <%= p[:page].menu %>
    <% end %>
  <%- end -%>
</ul>
