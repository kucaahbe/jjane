<%= title t(:title_filesystem) %>

<table class="list">
  <tr>
    <th width="95%"><%=t :name %></th>
    <th width="5%"><%=t :actions %></th>
  </tr>

  <% if @updir -%>
    <tr>
      <td>
	<%= engine_image 'folder.png' %>
	<%= link_to '[..]', (@updir.parent ? attached_file_path(@updir.parent) : attached_files_path) %>
      </td>
      <td>&nbsp;</td>
    </tr>
  <% end -%>

  <% @files.each do |file| -%>
    <tr>
      <td>
	<% if file.directory? -%>
	  <%= engine_image 'folder.png' %>
	  <%= link_to "[#{file.name}]", attached_file_path(file) %>
	<% else -%>
	  <%= engine_image 'file.png' %>
	  <%= link_to file.name, file.atachment.url %>
	<% end -%>
      </td>
      <td>
	<%= link_to_edit 'edit', edit_attached_file_path(file) %>
	<%= link_to_destroy file %>
      </td>
    </tr>
  <% end -%>
</table>

<br />

<%= link_to(t(:link_new_file), attached_file_upload_path(@updir)) if @updir %>
<br />
<%= link_to t(:link_new_dir), (@updir ? new_attached_file_directory_path(@updir) : new_attached_file_path) %>
